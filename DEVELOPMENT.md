# 开发指南

## 自动打包机制

本项目配置了自动打包机制，每当您提交代码变更时，系统会自动重新打包扩展并更新发布文件。这确保了GitHub上的发布包始终与最新代码同步。

### 工作原理

1. 当您运行 `git commit` 命令时，Git的pre-commit钩子会自动触发
2. 如果检测到代码文件（js/html/css/json/png）有变更，会自动运行打包脚本
3. 打包脚本会从manifest.json中提取版本号，创建相应的ZIP包
4. 脚本还会自动更新README.md中的下载链接，指向最新版本
5. 最后，打包文件和README更新会被自动添加到您的提交中

### 手动打包

如果需要手动打包扩展，可以直接运行：

```bash
./pack.sh
```

### 跳过自动打包

如果您希望跳过自动打包（例如，进行一些不影响代码的小修改），可以使用：

```bash
git commit --no-verify -m "您的提交信息"
```

### 更新版本号

当您需要发布新版本时，只需要更新 `manifest.json` 文件中的 `version` 字段，然后正常提交。打包脚本会自动使用新版本号创建发布包。

## 发布新版本

完整的发布流程：

1. 更新 `manifest.json` 中的版本号
2. 提交您的更改（这会自动触发打包）：`git commit -m "发布版本 X.X"`
3. 推送到GitHub：`git push`
4. 在GitHub上创建一个新的Release，使用与打包文件相同的标签（例如 v1.1）
5. 上传生成的ZIP文件作为Release资产

## 文件结构

- `pack.sh` - 打包脚本
- `.git/hooks/pre-commit` - Git提交前钩子
- `releases/` - 存放打包后的文件

## 注意事项

- 自动打包只在有代码文件变更时触发
- 确保您的manifest.json文件中的版本号始终是最新的
- 如果您在多台机器上开发，需要在每台机器上设置钩子 